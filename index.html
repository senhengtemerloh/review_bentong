<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Leave a Google Review - Grand Senheng Bentong</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root{
      --bg:#0b1220;          /* deep navy */
      --card:#0f1b33cc;      /* glass card */
      --primary:#7dd3fc;     /* sky accent */
      --secondary:#f472b6;   /* pink accent */
      --accent:#34d399;      /* green */
      --text:#e5f0ff;        /* light text */
      --muted:#96a3c2;       /* muted text */
      --ring:#60a5fa;        /* focus ring */
      --border:#1f2a44;      /* subtle border */
      --radius:16px;
      --space:16px;          /* base spacing for mobile */
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 1200px at 10% 0%, #183057 0%, transparent 50%),
        radial-gradient(1000px 1000px at 100% 0%, #3b1856 0%, transparent 50%),
        linear-gradient(180deg,#0b1220 0%,#0b1220 100%);
      padding:calc(var(--space) + env(safe-area-inset-top)) var(--space) calc(var(--space) + env(safe-area-inset-bottom));
    }

    .container{max-width:min(720px, 100%);margin:0 auto}

    header{ text-align:center; margin: 8px 0 18px; }
    header h1{
      font-size: clamp(1.25rem, 2.6vw + 1rem, 2rem);
      font-weight:700; letter-spacing:0.4px;
      line-height:1.2;
      background: linear-gradient(90deg,var(--primary),var(--secondary));
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    header p{color:var(--muted); margin-top:8px; font-size:0.95rem}

    .card{
      background:var(--card);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    .input-row{display:flex; gap:10px; align-items:center; margin-top:6px}
    .input-row .hash{font-weight:600; color:var(--muted); padding: 12px 10px; border-radius:12px}

    input[type="text"]{
      flex:1;
      background: rgba(255,255,255,0.06);
      border:1px solid var(--border);
      color:var(--text);
      border-radius:12px; min-height:48px; padding:0 12px;
      outline:none; transition:border .15s, box-shadow .15s;
      font-size:1rem;
    }
    input[type="text"]:focus{
      border-color: var(--ring);
      box-shadow: 0 0 0 4px rgba(96,165,250,0.25);
    }
    .hint{font-size:.9rem; color:var(--muted); margin-top:8px}

    .btn{ 
      border:none; cursor:pointer; font-weight:700; color:#0a1220;
      background: linear-gradient(90deg,var(--primary), var(--secondary));
      padding: 14px 16px; border-radius:12px; transition: transform .06s ease;
      box-shadow: 0 6px 20px rgba(125,211,252,.25);
      white-space:nowrap; min-height:48px; touch-action:manipulation;
    }
    .btn:active{ transform: scale(.98); }

    #review-section{ display:none; margin-top:16px }

    .review-card{
      background: rgba(255,255,255,0.06);
      border:1px solid var(--border);
      border-radius:var(--radius); padding:14px; margin-top:12px;
    }
    .review-text{ font-size:1.05rem; line-height:1.55; word-break:break-word }

    .copy-btn{
      margin-top:12px; width:100%; color:#051019; font-weight:800;
      background: linear-gradient(90deg,#34d399,#a7f3d0);
      border:none; padding:14px; border-radius:12px;
      box-shadow:0 8px 24px rgba(52,211,153,.25);
      transition: transform .06s ease;
      min-height:48px;
    }
    .copy-btn:active{ transform: scale(.98); }

    #refresh-btn{ 
      display:block; margin:16px auto 0; max-width:420px; width:100%;
      background: linear-gradient(90deg,#f59e0b,#f472b6);
      color:#0a1220; font-weight:800; padding:14px; border-radius:12px; border:none;
      box-shadow:0 8px 24px rgba(245,158,11,.25);
      min-height:48px;
    }

    .notification{
      position: fixed; left:50%; bottom: calc(12px + env(safe-area-inset-bottom)); transform:translateX(-50%);
      background: #101d36; color: var(--text); border:1px solid var(--border);
      padding:12px 16px; border-radius:12px; display:none; z-index:50;
      box-shadow:0 10px 30px rgba(0,0,0,.35);
      pointer-events:none;
    }

    @media (max-width:420px){ .input-row{flex-direction:column; align-items:stretch} .btn{width:100%} }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Leave a Google Review Â· Grand Senheng Bentong</h1>
      <p>Type your staff's nickname below. We'll add the hashtag to your review automatically.</p>
    </header>

    <!-- Manual Nickname Input -->
    <section class="card" aria-labelledby="nickname-label">
      <label id="nickname-label" for="nickname" style="font-weight:600">Staff nickname</label>
      <div class="input-row" style="margin-top:6px">
        <span class="hash">#</span>
        <input id="nickname" type="text" inputmode="latin" autocomplete="off" autocapitalize="off" spellcheck="false" placeholder="e.g. mus, syafiq, hairie" maxlength="18" />
        <button class="btn" id="start-btn" title="Show reviews" type="button">Show Reviews</button>
      </div>
      <p class="hint">Only letters & numbers are allowed. We'll format it as a hashtag like <strong id="live-hash">#</strong>.</p>
    </section>

    <section id="review-section">
      <header style="text-align:center; margin:14px 0 6px">
        <h1 style="font-size:1.35rem">Pick a Review</h1>
        <p class="hint">Tap copy and you'll be sent to Google Reviews.</p>
      </header>
      <div id="reviews"></div>
      <button id="refresh-btn" type="button">ðŸ”„ Show More Reviews</button>
    </section>
  </div>

  <div class="notification" id="notification" aria-live="polite">Copied to clipboard!</div>

  <script>
    /* ---------------------------------------------
       CONFIG
    --------------------------------------------- */
    const googleReviewURL = 'https://maps.app.goo.gl/tFDyxDjt7Vm3dU8k9';

    const additionalHashtags = [
      '#SCoin', '#Extendedwarranty', '#Replacementwarranty', '#O2O',
      '#Online2Offline', '#Credit', '#BNPL', '#BuyNowPayLater',
      '#Instalment', '#Ansuran', '#MudahMilik', '#SenangMilik',
      '#SenhengApp', '#Point', '#Cashback', '#Redeem',
      '#Delivery', '#Installation', '#Receipt', '#Invoice'
    ];

    /* ---------------------------------------------
       STATE
    --------------------------------------------- */
    let selectedHashtag = '';

    /* ---------------------------------------------
       REVIEWS (pool kept intact in spirit; add more as needed)
    --------------------------------------------- */
    const allReviews = [
      "Great experience with S-Coin redemption and free extra warranty. Friendly service throughout.",
      "Really pleased with my purchase â€“ got S-Coin cashback and a free extra warranty.",
      "The staff helped me redeem my S-Coin, plus I received a free extra warranty. Excellent service.",
      "Smooth process: used S-Coin for discounts and got an extra year of warranty free.",
      "I enjoyed a hassle-free experience, with S-Coin benefits and an extra warranty at no cost.",
      "Efficient service! Redeemed S-Coin easily and got an extra warranty for free.",
      "Amazing offers: free extra warranty and S-Coin cashback made my day.",
      "Used my S-Coin to save money and received a complimentary extra warranty.",
      "Excellent staff, very knowledgeable â€“ S-Coin redemption and extra warranty were simple.",
      "A great mix of benefits: S-Coin discounts and free extra warranty enhanced my purchase.",
      "Layanannya memang tip-top, guna S-Coin dapat jimat dan extra warranty free pun ada.",
      "Pengalaman beli yang memuaskan â€“ ada S-Coin cashback dan warranty percuma tambahan.",
      "Staff mesra dan membantu, mudah redeem S-Coin serta dapat extra warranty free.",
      "Transaksi lancar, guna S-Coin untuk diskaun dan dapat extra warranty secara free.",
      "Memang best! Dapat redeem S-Coin dan extra warranty free bila beli barang.",
      "Serba memuaskan, guna S-Coin untuk potongan dan ada free extra warranty juga.",
      "Layanannya bagus, staff terangkan dengan jelas, guna S-Coin dan dapat warranty free.",
      "Beli barang di sini, dapat S-Coin cashback serta extra warranty percuma.",
      "Transaksi senang, guna S-Coin dapat harga rendah, plus extra warranty free.",
      "Outlet ini memang terbaik, ada redeem S-Coin dan free extra warranty, puas hati."
    ];

    /* ---------------------------------------------
       HELPERS
    --------------------------------------------- */
    const lsKey = 'gsb_nick';
    function sanitizeNickname(raw){
      return (raw || '').toLowerCase().replace(/[^a-z0-9]+/g,'').slice(0,18);
    }
    function getRandomHashtags(){
      const shuffled = additionalHashtags.slice().sort(()=>0.5 - Math.random());
      const amount = Math.floor(Math.random()*2) + 1; // 1 or 2
      return shuffled.slice(0,amount).join(' ');
    }
    function showNotification(){
      const n = document.getElementById('notification');
      n.style.display='block';
      setTimeout(()=>{ n.style.display='none'; }, 1000);
    }

    // âœ… Robust copy + redirect: do a synchronous copy first (preserves user gesture),
    // also try async clipboard if available, then redirect this tab.
    function copyAndGo(str){
      // Sync fallback first
      try {
        const ta = document.createElement('textarea');
        ta.value = str;
        ta.setAttribute('readonly','');
        ta.style.position = 'fixed';
        ta.style.top = '-9999px';
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
      } catch (_) {}

      // Best-effort async
      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(str).catch(()=>{});
      }

      showNotification();
      // Immediate redirect keeps user activation intact (avoids popup blockers)
      window.location.href = googleReviewURL;
    }

    /* ---------------------------------------------
       RENDER
    --------------------------------------------- */
    function generateReviews(){
      const nicknameInput = document.getElementById('nickname');
      const nick = sanitizeNickname(nicknameInput.value);
      if(!nick){
        nicknameInput.focus();
        nicknameInput.setAttribute('aria-invalid','true');
        document.getElementById('review-section').style.display='none';
        return;
      }
      localStorage.setItem(lsKey, nick);
      selectedHashtag = `#${nick}`;

      const shuffled = allReviews.slice().sort(()=>0.5 - Math.random());
      const selectedReviews = shuffled.slice(0,3);

      const container = document.getElementById('reviews');
      container.innerHTML = '';

      selectedReviews.forEach(text => {
        const full = `${text} ${selectedHashtag} ${getRandomHashtags()}`.trim();

        const card = document.createElement('div');
        card.className = 'review-card';

        const p = document.createElement('div');
        p.className = 'review-text';
        p.textContent = full; // avoid HTML injection & attribute escaping issues

        const btn = document.createElement('button');
        btn.className = 'copy-btn';
        btn.type = 'button';
        btn.textContent = 'ðŸ“‹ Copy & Leave Review';
        btn.addEventListener('click', () => copyAndGo(full));

        card.appendChild(p);
        card.appendChild(btn);
        container.appendChild(card);
      });

      document.getElementById('review-section').style.display='block';
      document.getElementById('review-section').scrollIntoView({behavior:'smooth', block:'start'});
    }

    /* ---------------------------------------------
       EVENTS
    --------------------------------------------- */
    const nicknameEl = document.getElementById('nickname');
    const liveHash = document.getElementById('live-hash');

    const prev = localStorage.getItem(lsKey);
    if(prev){ nicknameEl.value = prev; liveHash.textContent = `#${prev}`; }

    nicknameEl.addEventListener('input', ()=>{
      const nick = sanitizeNickname(nicknameEl.value);
      liveHash.textContent = nick ? `#${nick}` : '#';
    });

    document.getElementById('start-btn').addEventListener('click', generateReviews);
    document.getElementById('refresh-btn').addEventListener('click', generateReviews);

    nicknameEl.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){ e.preventDefault(); generateReviews(); }
    });
  </script>
</body>
</html>
